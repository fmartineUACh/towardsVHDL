<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0047)http://det.bp.ehu.es/vhdl/pagina/express/11.htm -->
<HTML><HEAD><TITLE>Práctica 11: Contador</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META content="Daniel Jiménez Iglesias          danieljimenez@mailcity.com" 
name=Author>
<META content="Daniel Jiménez Iglesias y Juan Carlos Cárdenas Bonelli" 
name=Author>
<META content="Juan Carlos Cárdenas Bonelli     juanky.cardenas@mailcity.com" 
name=Author>
<META content="MSHTML 5.50.4134.100" name=GENERATOR></HEAD>
<BODY bgProperties=fixed background=11_archivos/fondo00.jpg>
<SCRIPT language=JavaScript><!--
MSFPhover = 
  (((navigator.appName == "Netscape") && 
  (parseInt(navigator.appVersion) >= 3 )) || 
  ((navigator.appName == "Microsoft Internet Explorer") && 
  (parseInt(navigator.appVersion) >= 4 ))); 
function MSFPpreload(img) 
{
  var a=new Image(); a.src=img; return a; 
}
// -->

</SCRIPT>

<SCRIPT language=JavaScript><!--
if(MSFPhover) { MSFPnav1n=MSFPpreload('boto10.jpg'); 
MSFPnav1h=MSFPpreload('boto11.jpg'); }
// --></SCRIPT>

<SCRIPT language=JavaScript><!--
if(MSFPhover) { MSFPnav2n=MSFPpreload('boto20.jpg'); 
MSFPnav2h=MSFPpreload('boto21.jpg'); }
// --></SCRIPT>

<SCRIPT language=JavaScript><!--
if(MSFPhover) { MSFPnav3n=MSFPpreload('boto30.jpg'); 
MSFPnav3h=MSFPpreload('boto31.jpg'); }
// --></SCRIPT>

<SCRIPT language=JavaScript><!--
if(MSFPhover) { MSFPnav4n=MSFPpreload('boto40.jpg'); 
MSFPnav4h=MSFPpreload('boto41.jpg'); }
// --></SCRIPT>

<DIV align=center>
<CENTER>
<TABLE height=515 cellSpacing=5 cellPadding=2 width="90%" border=0>
  <TBODY>
  <TR>
    <TD vAlign=center align=middle width="100%" height=81><A name=0></A><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/10.htm"><IMG height=47 
      alt="Flip Flops" src="11_archivos/image07.jpg" width=66 
      border=0></A><SMALL><IMG height=54 alt="Práctica 14: Contador" 
      src="11_archivos/ex11-00.jpg" width=446 
      lowsrc=images/ex11-00.gif></SMALL><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/12.htm"><IMG height=45 
      alt=Secuenciador src="11_archivos/image08.jpg" width=68 
      border=0></A><BR>&nbsp; </TD></TR>
  <TR>
    <TD vAlign=center align=left width="100%" height=66><FONT face=Verdana 
      size=2>Un contador es un dispositivo lógico sínrono o asíncrono, en cuyas 
      salidas tenemos un número que va creciendo o decreciendo a intervalos 
      regulares según lo hayamos especificado nosotros. Suelen contar así mismo 
      con entrada de reset y preset (a partir de que número se 
  cuenta).</FONT></TD></TR>
  <TR>
    <TD vAlign=center align=middle width="100%" height=66><SMALL><FONT 
      face=Verdana>
      <P align=left>Los comparadores pueden contar tanto en binario natural, 
      BCD, octal,... y contar de uno en uno, de dos en 
dos,...</FONT></SMALL></P>
      <P align=left><SMALL><FONT face=Verdana>Elige en la lista una práctica 
      para empezar, sin más que pinchar en el botón adecuado. Para volver pulsa 
      el botón que está al lado del título</FONT></SMALL></P></TD></TR>
  <TR>
    <TD align=middle width="100%" height=245>
      <DIV align=left>
      <TABLE style="FLOAT: left" height=158 cellSpacing=4 cellPadding=2 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=center width="28%" height=35>
            <P><A href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#1"><IMG 
            height=29 alt="Entidad 1" src="11_archivos/enti1.jpg" width=200 
            border=0></A></P></TD>
          <TD vAlign=center width="72%" height=35><FONT face=Arial 
            size=3><STRONG>Contador ascendente</STRONG></FONT></TD></TR>
        <TR>
          <TD vAlign=center width="28%" height=35>
            <P><A href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#2"><IMG 
            height=29 alt="Entidad 2" src="11_archivos/enti2.jpg" width=200 
            border=0></A></P></TD>
          <TD vAlign=center width="72%" height=35><FONT face=Arial 
            size=3><STRONG>Contador ascendente con carga</STRONG></FONT></TD></TR>
        <TR>
          <TD vAlign=center width="28%" height=35>
            <P><A href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#3"><IMG 
            height=29 alt="Entidad 3" src="11_archivos/enti3.jpg" width=200 
            border=0></A></P></TD>
          <TD vAlign=center width="72%" height=35><FONT face=Arial 
            size=3><STRONG>Contador ascendente con carga y 
          reset</STRONG></FONT></TD></TR>
        <TR>
          <TD vAlign=center width="28%" height=35>
            <P><A href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#4"><IMG 
            height=29 alt="Entidad 4" src="11_archivos/enti4.jpg" width=200 
            border=0></A></P></TD>
          <TD vAlign=center width="72%" height=35><FONT face=Arial 
            size=3><STRONG>Contador ascendente / descendente con carga y 
            reset</STRONG></FONT></TD></TR>
        <TR>
          <TD vAlign=center width="28%" height=35><A 
            href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#5"><IMG 
            height=29 alt="Entidad 5" src="11_archivos/enti5.jpg" width=200 
            border=0></A></TD>
          <TD vAlign=center width="72%" height=35><FONT face=Arial 
            size=3><STRONG>Contador 
BCD</STRONG></FONT></TD></TR></TBODY></TABLE></DIV>
      <P>&nbsp;</P></TD></TR>
  <TR>
    <TD align=middle width="100%" height=7><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/simula.htm#11"><IMG 
      height=24 alt="Pulsa aquí para simular los ejemplos construidos." 
      src="11_archivos/image03.jpg" width=614 lowsrc=image03.gif 
  border=0></A></TD></TR></TBODY></TABLE></CENTER></DIV>
<P align=center>&nbsp;</P>
<P align=center>&nbsp;</P>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="85%"><FONT face=Impact color=#000000><BIG><BIG><A 
      name=1></A>Ejercicio 1: </BIG></BIG></FONT><FONT face=Impact 
      size=5>Contador ascendente</FONT></TD>
    <TD width="7%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#top"><IMG height=42 
      alt="Ir al principio de esta página" src="11_archivos/image01.gif" 
      width=59 align=right border=0></A></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">Este contador es muy 
simple ya que no tiene ningún tipo de control, ya que cuenta de 0 a 15 una vez 
tras otra, sin poder influir sobre ello, más que en la frecuencia, al variar los 
pulsos de reloj. Necesitaremos por lo tanto la entrada de reloj y la salida (de 
cuatro bits).</FONT></P>
<TABLE height=364 width="100%" bgColor=#ffffff border=0>
  <TBODY>
  <TR>
    <TD width="59%" height=53><FONT face="OCR A Extended"><STRONG>library 
      ieee</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>ieee</STRONG>.std_logic_1164.<STRONG>all</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>work</STRONG>.std_arith.<STRONG>all</STRONG>;</FONT></TD>
    <TD width="41%" height=53><FONT face=Verdana><SMALL>Declaración de 
      librerías para usar el tipo <STRONG>std_logic</STRONG> y para poder usar 
      el signo <STRONG>+</STRONG> para sumar</SMALL></FONT></TD></TR>
  <TR>
    <TD width="59%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="41%" height=19><FONT face=Verdana><SMALL>&nbsp; 
    </SMALL></FONT></TD></TR>
  <TR>
    <TD width="59%" height=98><FONT 
      face="OCR A Extended"><STRONG>entity</STRONG> contador <STRONG>is</STRONG> 
      <STRONG>port</STRONG>(<BR>clk:&nbsp;&nbsp; <STRONG>&nbsp;&nbsp;&nbsp; 
      in</STRONG> std_logic;<BR>conta: <STRONG>buffer</STRONG> 
      std_logic_vector(3 <STRONG>downto</STRONG> 
      0)<BR>);<BR><STRONG>end</STRONG> contador;</FONT></TD>
    <TD width="41%" height=98><SMALL><FONT face=Verdana>Declaración de la 
      entrada de reloj (<STRONG>clk</STRONG>), y de la salida 
      <STRONG>conta</STRONG>.</FONT></SMALL></TD></TR>
  <TR>
    <TD width="59%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="41%" height=19><SMALL><FONT face=Verdana>&nbsp; 
    </FONT></SMALL></TD></TR>
  <TR>
    <TD width="59%" height=155><FONT 
      face="OCR A Extended"><STRONG>architecture</STRONG> archicontador 
      <STRONG>of</STRONG> contador 
      <STRONG>is</STRONG><BR><STRONG>begin</STRONG><BR><STRONG>process</STRONG> 
      (clk)<BR><STRONG>begin</STRONG><BR>&nbsp; <STRONG>if</STRONG> 
      (clk'<STRONG>event</STRONG> <STRONG>and</STRONG> clk= '1') 
      <STRONG>then</STRONG><BR>&nbsp;&nbsp;&nbsp; conta &lt;= conta + 
      1;<BR>&nbsp; <STRONG>end if</STRONG>;<BR><STRONG>end 
      process</STRONG>;<BR><STRONG>end archicontador</STRONG>;</FONT></TD>
    <TD width="41%" height=155><SMALL><FONT face=Verdana>En el flanco de 
      subida del reloj, se ejecuta lo que sigue al <STRONG>then</STRONG>: sumar 
      1 a la señal <STRONG>conta</STRONG>. </FONT></SMALL></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">Lo único a destacar de 
este ejercicio es que la salida debe ser del <A 
href="http://det.bp.ehu.es/vhdl/pagina/completo/02.htm#3">tipo 
<STRONG>buffer</STRONG></A>, no del tipo <STRONG>out</STRONG>, ya que debemos 
conocer la salida que tenemos, para poder sumarla uno. Este ejemplo no merece 
más comentarios, ya que iremos añadiendo operatividad a medida que avancemos en 
esta práctica.</FONT></P>
<P align=left>&nbsp;</P>
<TABLE width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="25%"></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/simula.htm"><IMG height=28 
      alt="Qué debes saber antes de simular" src="11_archivos/image09.jpg" 
      width=211 lowsrc=image09.gif border=0></A></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/practica/conta01.vhd"><IMG 
      height=28 alt="Pulsa aquí para ver el código fuente" 
      src="11_archivos/image10.jpg" width=211 lowsrc=image10.gif 
border=0></A></TD>
    <TD width="25%"></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;</P>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="85%"><FONT face=Impact color=#000000><BIG><BIG><A 
      name=2></A>Ejercicio 2: </BIG></BIG></FONT><FONT face=Impact 
      size=5>Contador ascendente con carga</FONT></TD>
    <TD width="7%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#top"><IMG height=42 
      alt="Ir al principio de esta página" src="11_archivos/image01.gif" 
      width=59 align=right border=0></A></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">Este contador se 
diferencia del anterior en que le podremos indicar a partir de qué número 
queremos que empiece a contar, por lo que deberemos añadirle una entrada para el 
número en cuestión y otra par indicarle que queremos que lo use.</FONT></P>
<TABLE height=364 width="100%" bgColor=#ffffff border=0>
  <TBODY>
  <TR>
    <TD width="58%" height=53><FONT face="OCR A Extended"><STRONG>library 
      ieee</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>ieee</STRONG>.std_logic_1164.<STRONG>all</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>work</STRONG>.std_arith.<STRONG>all</STRONG>;</FONT></TD>
    <TD width="42%" height=53><FONT face=Verdana><SMALL>Declaración de 
      librerías para usar el tipo <STRONG>std_logic</STRONG> y para poder usar 
      el signo <STRONG>+</STRONG> para sumar</SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><FONT face=Verdana><SMALL>&nbsp; 
    </SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=98><FONT 
      face="OCR A Extended"><STRONG>entity</STRONG> contador <STRONG>is</STRONG> 
      <STRONG>port</STRONG>(<BR>clk, load:<STRONG>in</STRONG> 
      std_logic;<BR>data:&nbsp;&nbsp;&nbsp; <STRONG>in</STRONG> 
      std_logic_vector(3 <STRONG>downto</STRONG> 
      0);<BR>conta:<STRONG>buffer</STRONG> std_logic_vector(3 
      <STRONG>downto</STRONG> 0)<BR>);<BR><STRONG>end</STRONG> 
    contador;</FONT></TD>
    <TD width="42%" height=98><SMALL><FONT face=Verdana>Declaración de la 
      entrada de reloj (<STRONG>clk</STRONG>), y de la salida 
      <STRONG>conta</STRONG>. Ahora le añadimos la entrada <STRONG>load</STRONG> 
      que indica que si queremos que empiece a contar a partir del número 
      <STRONG>data</STRONG></FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><SMALL><FONT face=Verdana>&nbsp; 
    </FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=155><FONT 
      face="OCR A Extended"><STRONG>architecture</STRONG> archicontador 
      <STRONG>of</STRONG> contador 
      <STRONG>is</STRONG><BR><STRONG>begin</STRONG><BR><STRONG>process</STRONG> 
      (clk)<BR><STRONG>begin</STRONG><BR>&nbsp; if (clk'event and clk= '1') 
      then<BR>&nbsp;&nbsp; if load = '1' then<BR>&nbsp;&nbsp;&nbsp; conta &lt;= 
      data;<BR>&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp; conta &lt;= conta + 
      1;<BR>&nbsp;&nbsp; end if;<BR>&nbsp; end if;<BR><STRONG>end 
      process</STRONG>;<BR><STRONG>end archicontador</STRONG>;</FONT></TD>
    <TD width="42%" height=155><SMALL><FONT face=Verdana>Ahora, si hay un 
      flanco de subida en <STRONG>clk</STRONG>, primero se comprueba si se pide 
      contar a partir cierto número (si <STRONG>load</STRONG> está habilitada), 
      y si es así, el contador se inicializa con el valor de 
      <STRONG>data</STRONG>. Si no lo es, se le suma 1 a la 
    salida</FONT></SMALL></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">Lo único a destacar de 
este ejercicio es que al haber dos sentencias <A 
href="http://det.bp.ehu.es/vhdl/pagina/completo/04.htm#4"><STRONG>if</STRONG></A> 
deberemos cerrar ambas. VHDL, como todos los lenguajes de programación, cierra 
primero la última sentencia <STRONG>if</STRONG> en abrirse.</FONT></P>
<P align=left>&nbsp;</P>
<TABLE width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="25%"></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/simula.htm"><IMG height=28 
      alt="Qué debes saber antes de simular" src="11_archivos/image09.jpg" 
      width=211 lowsrc=image09.gif border=0></A></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/practica/conta02.vhd"><IMG 
      height=28 alt="Pulsa aquí para ver el código fuente" 
      src="11_archivos/image10.jpg" width=211 lowsrc=image10.gif 
border=0></A></TD>
    <TD width="25%"></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;</P>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="85%"><FONT face=Impact color=#000000><BIG><BIG><A 
      name=3></A>Ejercicio 3: </BIG></BIG></FONT><FONT face=Impact 
      size=5>Contador ascendente con carga y reset</FONT></TD>
    <TD width="7%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#top"><IMG height=42 
      alt="Ir al principio de esta página" src="11_archivos/image01.gif" 
      width=59 align=right border=0></A></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">A este contador le hemos 
añadido ahora una señal de reset (asíncrono), que hará que el contador se ponga 
a cero mientras dure este pulso. Una vez acabado la inicialización vuelve a 
cmprobar si se le pide que cuente a partir de <STRONG>load</STRONG>, o si cuenta 
normalmente.</FONT></P>
<TABLE height=364 width="100%" bgColor=#ffffff border=0>
  <TBODY>
  <TR>
    <TD width="58%" height=53><FONT face="OCR A Extended"><STRONG>library 
      ieee</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>ieee</STRONG>.std_logic_1164.<STRONG>all</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>work</STRONG>.std_arith.<STRONG>all</STRONG>;</FONT></TD>
    <TD width="42%" height=53><FONT face=Verdana><SMALL>Declaración de 
      librerías para usar el tipo <STRONG>std_logic</STRONG> y para poder usar 
      el signo <STRONG>+</STRONG> para sumar</SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><FONT face=Verdana><SMALL>&nbsp; 
    </SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=98><FONT 
      face="OCR A Extended"><STRONG>entity</STRONG> contador <STRONG>is</STRONG> 
      <STRONG>port</STRONG>(<BR>clk, load, reset:<STRONG>in</STRONG> 
      std_logic;<BR>data:&nbsp;&nbsp;&nbsp; <STRONG>in</STRONG> 
      std_logic_vector(3 <STRONG>downto</STRONG> 
      0);<BR>conta:<STRONG>buffer</STRONG> std_logic_vector(3 
      <STRONG>downto</STRONG> 0)<BR>);<BR><STRONG>end</STRONG> 
    contador;</FONT></TD>
    <TD width="42%" height=98><SMALL><FONT face=Verdana>Declaración de la 
      entrada de reloj (<STRONG>clk</STRONG>) y de la carga 
      (<STRONG>load</STRONG> y <STRONG>data</STRONG>). Ahora le añadimos la 
      señal de <STRONG>reset</STRONG>. <STRONG>Conta</STRONG> es la 
      salida.</FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><SMALL><FONT face=Verdana>&nbsp; 
    </FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=155><FONT 
      face="OCR A Extended"><STRONG>architecture</STRONG> archicontador 
      <STRONG>of</STRONG> contador 
      <STRONG>is</STRONG><BR><STRONG>begin</STRONG><BR><STRONG>process</STRONG> 
      (clk,reset)<BR><STRONG>begin</STRONG><BR>&nbsp; <STRONG>if</STRONG> reset 
      = '1' <STRONG>then</STRONG><BR>&nbsp;&nbsp; conta &lt;= "0000";<BR>&nbsp; 
      <STRONG>elsif</STRONG> (clk'<STRONG>event</STRONG> <STRONG>and</STRONG> 
      clk= '1') <STRONG>then</STRONG><BR>&nbsp;&nbsp; <STRONG>if</STRONG> load = 
      '1' <STRONG>then</STRONG><BR>&nbsp;&nbsp;&nbsp; conta &lt;= 
      data;<BR>&nbsp;&nbsp; <STRONG>else</STRONG><BR>&nbsp;&nbsp;&nbsp; conta 
      &lt;= conta + 1;<BR>&nbsp;&nbsp; <STRONG>end if</STRONG>;<BR>&nbsp; 
      <STRONG>end if</STRONG>;<BR><STRONG>end process</STRONG>;<BR><STRONG>end 
      archicontador</STRONG>;</FONT></TD>
    <TD width="42%" height=155><SMALL><FONT face=Verdana>Ahora, si hay un 
      flanco de subida en <STRONG>clk</STRONG>, o hay un cambio en la señal 
      <STRONG>reset</STRONG>, primero se comprueba si esta última ha sido 
      habilitada, lo cual hace que <STRONG>conta</STRONG> se ponga a "0000". Si 
      lo que ha cambiado ha sido la señal <STRONG>clk</STRONG> (reloj), se 
      siguen los mismos pasos que antes: se verifica si se pide contar a partir 
      cierto número (si <STRONG>load</STRONG> está habilitada), y si es así, el 
      contador se inicializa con el valor de <STRONG>data</STRONG>. Si no lo es, 
      se le suma 1 a la salida</FONT></SMALL></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">Si el contador llega a 
"1111", y le sumamos uno, la salida que obtengamos será "0000", ya que 
automáticamente VHDL realiza la operación de despreciar el overflow que se 
daría, ya que el resultado debiera de ser de cinco bits y no de cuatro, tal y 
como hemos declarado la salida.</FONT></P>
<P align=left>&nbsp;</P>
<TABLE width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="25%"></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/simula.htm"><IMG height=28 
      alt="Qué debes saber antes de simular" src="11_archivos/image09.jpg" 
      width=211 lowsrc=image09.gif border=0></A></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/practica/conta03.vhd"><IMG 
      height=28 alt="Pulsa aquí para ver el código fuente" 
      src="11_archivos/image10.jpg" width=211 lowsrc=image10.gif 
border=0></A></TD>
    <TD width="25%"></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;</P>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="85%"><FONT face=Impact color=#000000><BIG><BIG><A 
      name=4></A>Ejercicio 4: </BIG></BIG></FONT><FONT face=Impact 
      size=5>Contador ascendente/descendente&nbsp; con carga y reset</FONT></TD>
    <TD width="7%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#top"><IMG height=42 
      alt="Ir al principio de esta página" src="11_archivos/image01.gif" 
      width=59 align=right border=0></A></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">Ahora deberemos modificar 
el código del contador anterior par que según le indiquemos con una señal nueva, 
llamada <STRONG>arriba</STRONG>, cuente hacia arriba como hacia abajo, según le 
digamos. Esta señal basta con que sea de un solo bit.</FONT></P>
<TABLE height=364 width="100%" bgColor=#ffffff border=0>
  <TBODY>
  <TR>
    <TD width="58%" height=53><FONT face="OCR A Extended"><STRONG>library 
      ieee</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>ieee</STRONG>.std_logic_1164.<STRONG>all</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>work</STRONG>.std_arith.<STRONG>all</STRONG>;</FONT></TD>
    <TD width="42%" height=53><FONT face=Verdana><SMALL>Declaración de 
      librerías para usar el tipo <STRONG>std_logic</STRONG> y para poder usar 
      el signo <STRONG>+</STRONG> para sumar</SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><FONT face=Verdana><SMALL>&nbsp; 
    </SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=98><FONT 
      face="OCR A Extended"><STRONG>entity</STRONG> contador <STRONG>is</STRONG> 
      <STRONG>port</STRONG>(<BR>clk, load, reset,arriba:<STRONG>in</STRONG> 
      std_logic;<BR>data:&nbsp;&nbsp;&nbsp; <STRONG>in</STRONG> 
      std_logic_vector(3 <STRONG>downto</STRONG> 
      0);<BR>conta:<STRONG>buffer</STRONG> std_logic_vector(3 
      <STRONG>downto</STRONG> 0)<BR>);<BR><STRONG>end</STRONG> 
    contador;</FONT></TD>
    <TD width="42%" height=98><SMALL><FONT face=Verdana>Declaración de la 
      entrada de reloj (<STRONG>clk</STRONG>), de la carga 
      (<STRONG>load</STRONG> y <STRONG>data</STRONG>), la señal de 
      <STRONG>reset</STRONG> y además la que indica si cuenta hacia arriba como 
      hacia abajo. <STRONG>Conta</STRONG> es la salida.</FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><SMALL><FONT face=Verdana>&nbsp; 
    </FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=155><FONT 
      face="OCR A Extended"><STRONG>architecture</STRONG> archicontador 
      <STRONG>of</STRONG> contador 
      <STRONG>is</STRONG><BR><STRONG>begin</STRONG><BR><STRONG>process</STRONG> 
      (clk,reset)<BR><STRONG>begin</STRONG><BR>&nbsp; <STRONG>if</STRONG> reset 
      = '1' <STRONG>then</STRONG><BR>&nbsp;&nbsp; conta &lt;= "0000";<BR>&nbsp; 
      <STRONG>elsif</STRONG> (clk'<STRONG>event</STRONG> <STRONG>and</STRONG> 
      clk= '1') <STRONG>then</STRONG><BR>&nbsp;&nbsp; <STRONG>if</STRONG> load = 
      '1' <STRONG>then</STRONG><BR>&nbsp;&nbsp;&nbsp; conta &lt;= 
      data;<BR>&nbsp;&nbsp; <STRONG>elsif</STRONG> arriba = '1' 
      <STRONG>then</STRONG><BR>&nbsp;&nbsp;&nbsp; conta &lt;= conta + 
      1;<BR>&nbsp;&nbsp; <STRONG>else</STRONG> conta &lt;= conta - 
      1;<BR>&nbsp;&nbsp; <STRONG>end if</STRONG>;<BR>&nbsp; <STRONG>end 
      if</STRONG>;<BR><STRONG>end process</STRONG>;<BR><STRONG>end 
      archicontador</STRONG>;</FONT></TD>
    <TD width="42%" height=155><SMALL><FONT face=Verdana>Ahora, si hay un 
      flanco de subida en <STRONG>clk</STRONG>, o hay un cambio en la señal 
      <STRONG>reset</STRONG>, primero se comprueba si esta última ha sido 
      habilitada, lo cual hace que <STRONG>conta</STRONG> se ponga a "0000". Si 
      lo que ha cambiado ha sido la señal <STRONG>clk</STRONG> (reloj), se 
      verifica si se pide contar a partir cierto número (si 
      <STRONG>load</STRONG> está habilitada), y si es así, el contador se 
      inicializa con el valor de <STRONG>data</STRONG>. Si no lo es, se analiza 
      si se le pide contar hacia arriba o hacia abajo, sumándole 1 a la salida o 
      restándoselo, respectivamente. </FONT></SMALL></TD></TR></TBODY></TABLE>
<P align=left><FONT face="MS Sans Serif">&nbsp;&nbsp;&nbsp; Deberemos tener en 
cuidado en este caso, ante la cantidad de <STRONG>if</STRONG>'s y de 
<STRONG>elsif</STRONG>, dentro de cuál de ellos estamos, a la hora de cerrarlos 
o de asignar cambios a señales, ya que el resultado puede ser distinto al que 
queríamos.</FONT></P>
<P align=left>&nbsp;</P>
<TABLE width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="25%"></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/simula.htm"><IMG height=28 
      alt="Qué debes saber antes de simular" src="11_archivos/image09.jpg" 
      width=211 lowsrc=image09.gif border=0></A></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/practica/conta04.vhd"><IMG 
      height=28 alt="Pulsa aquí para ver el código fuente" 
      src="11_archivos/image10.jpg" width=211 lowsrc=image10.gif 
border=0></A></TD>
    <TD width="25%"></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;</P>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="85%"><FONT face=Impact color=#000000><BIG><BIG><A 
      name=5></A>Ejercicio 5: </BIG></BIG></FONT><FONT face=Impact 
      size=5>Contador BCD</FONT></TD>
    <TD width="7%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/11.htm#top"><IMG height=42 
      alt="Ir al principio de esta página" src="11_archivos/image01.gif" 
      width=59 align=right border=0></A></TD></TR></TBODY></TABLE>
<P align=left>&nbsp;&nbsp; <FONT face="MS Sans Serif">Nuestro objetivo ahora es 
modificar el contador anterior, para conseguir que cuente de 0 a 9, es decir, 
que cuente en BCD.</FONT></P>
<TABLE height=364 width="100%" bgColor=#ffffff border=0>
  <TBODY>
  <TR>
    <TD width="58%" height=53><FONT face="OCR A Extended"><STRONG>library 
      ieee</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>ieee</STRONG>.std_logic_1164.<STRONG>all</STRONG>;<BR><STRONG>use</STRONG> 
      <STRONG>work</STRONG>.std_arith.<STRONG>all</STRONG>;</FONT></TD>
    <TD width="42%" height=53><FONT face=Verdana><SMALL>Declaración de 
      librerías para usar el tipo <STRONG>std_logic</STRONG> y para poder usar 
      el signo <STRONG>+</STRONG> para sumar</SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><FONT face=Verdana><SMALL>&nbsp; 
    </SMALL></FONT></TD></TR>
  <TR>
    <TD width="58%" height=98><FONT 
      face="OCR A Extended"><STRONG>entity</STRONG> contador <STRONG>is</STRONG> 
      <STRONG>port</STRONG>(<BR>clk, load, reset,arriba:<STRONG>in</STRONG> 
      std_logic;<BR>data:&nbsp;&nbsp;&nbsp; <STRONG>in</STRONG> 
      std_logic_vector(3 <STRONG>downto</STRONG> 
      0);<BR>conta:<STRONG>buffer</STRONG> std_logic_vector(3 
      <STRONG>downto</STRONG> 0)<BR>);<BR><STRONG>end</STRONG> 
    contador;</FONT></TD>
    <TD width="42%" height=98><SMALL><FONT face=Verdana>Declaración de la 
      entrada de reloj (<STRONG>clk</STRONG>), de la carga 
      (<STRONG>load</STRONG> y <STRONG>data</STRONG>), la señal de 
      <STRONG>reset</STRONG> y además la que indica si cuenta hacia arriba como 
      hacia abajo. <STRONG>Conta</STRONG> es la salida.</FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=19><FONT face="OCR A Extended">&nbsp; </FONT></TD>
    <TD width="42%" height=19><SMALL><FONT face=Verdana>&nbsp; 
    </FONT></SMALL></TD></TR>
  <TR>
    <TD width="58%" height=155><FONT 
      face="OCR A Extended"><STRONG>architecture</STRONG> archicontador 
      <STRONG>of</STRONG> contador 
      <STRONG>is</STRONG><BR><STRONG>begin</STRONG><BR><STRONG>process</STRONG> 
      (clk,reset)<BR><STRONG>begin</STRONG><BR>&nbsp; <STRONG>if</STRONG> reset 
      = '1' <STRONG>then</STRONG><BR>&nbsp;&nbsp; conta &lt;= "0000";<BR>&nbsp; 
      <STRONG>elsif</STRONG> (clk'<STRONG>event</STRONG> <STRONG>and</STRONG> 
      clk= '1') <STRONG>then</STRONG><BR>&nbsp;&nbsp; <STRONG>if</STRONG> load = 
      '1' <STRONG>then</STRONG><BR>&nbsp; &nbsp;&nbsp; conta &lt;= 
      data;<BR>&nbsp;&nbsp;&nbsp; <STRONG>elsif</STRONG> arriba = '1' 
      <STRONG>then</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>if</STRONG> 
      conta = "1001" <STRONG>then</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      conta &lt;= "0000";<BR>&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>else</STRONG> 
      conta &lt;= conta + 1;<BR>&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>end</STRONG> 
      <STRONG>if</STRONG>;<BR>&nbsp;&nbsp;&nbsp; 
      <STRONG>else</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>if</STRONG> 
      conta = "0000" <STRONG>then</STRONG><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
      conta &lt;= "1001";<BR>&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>else</STRONG> 
      conta &lt;= conta - 1;<BR>&nbsp;&nbsp;&nbsp; <STRONG>end 
      if</STRONG>;<BR>&nbsp;&nbsp; <STRONG>end if</STRONG>;<BR>&nbsp; 
      <STRONG>end if</STRONG>;<BR><STRONG>end process</STRONG>;<BR><STRONG>end 
      archicontador</STRONG>;</FONT></TD>
    <TD width="42%" height=155><SMALL><FONT face=Verdana>Ahora, si hay un 
      flanco de subida en <STRONG>clk</STRONG>, o hay un cambio en la señal 
      <STRONG>reset</STRONG>, primero se comprueba si esta última ha sido 
      habilitada, lo cual hace que <STRONG>conta</STRONG> se ponga a "0000". Si 
      lo que ha cambiado ha sido la señal <STRONG>clk</STRONG> (reloj), se 
      verifica si se pide contar a partir cierto número (si 
      <STRONG>load</STRONG> está habilitada), y si es así, el contador se 
      inicializa con el valor de <STRONG>data</STRONG>. Si no lo es, se analiza 
      si se le pide contar hacia arriba o hacia abajo. Antes de sumarle uno, 
      comprueba si hemos llegado al límite (9), y si lo hemos hecho, se pone 
      <STRONG>conta</STRONG> a "0000", si no es así, le suma uno. Realiza la 
      misma operación pero comprobando si hemos llegado al otro límite (0), y si 
      es así, pone <STRONG>conta</STRONG> a "1001". Si no lo es se resta uno a 
      la salida.</FONT></SMALL></TD></TR></TBODY></TABLE>
<P align=left><FONT face="MS Sans Serif">&nbsp;&nbsp;&nbsp; Ahora deberemos 
extremar el cuidado con los <STRONG>if</STRONG>'s que hay, por lo que deberemos 
organizar el testo de tal forma que no nos lleve a error. Ante tantos 
<STRONG>if</STRONG>'s, deberemos plantearnos si es mejor utilizar la sentencia 
<A 
href="http://det.bp.ehu.es/vhdl/pagina/completo/04.htm#5"><STRONG>case</STRONG></A>.</FONT></P>
<P align=left>&nbsp;</P>
<TABLE width="100%" border=0>
  <TBODY>
  <TR>
    <TD width="25%"></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/simula.htm"><IMG height=28 
      alt="Qué debes saber antes de simular" src="11_archivos/image09.jpg" 
      width=211 lowsrc=image09.gif border=0></A></TD>
    <TD width="25%"><A 
      href="http://det.bp.ehu.es/vhdl/pagina/express/practica/conta05.vhd"><IMG 
      height=28 alt="Pulsa aquí para ver el código fuente" 
      src="11_archivos/image10.jpg" width=211 lowsrc=image10.gif 
border=0></A></TD>
    <TD width="25%"></TD></TR></TBODY></TABLE>
<P align=center><FONT face="MS Sans Serif"><IMG height=10 
alt="Separa01.gif (636 bytes)" src="11_archivos/separa01.gif" 
width=708></FONT></P>
<DL>
  <DD>
  <P align=center>&nbsp;</P></DD></DL></BODY></HTML>
